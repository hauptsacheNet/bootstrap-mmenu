// this file requires bootstrap variables to be present

.mmenu {
  background-color: @navbar-default-bg;

  // desktop
  @media (min-width: @grid-float-breakpoint) {
    &.collapse {
      display: block;
      visibility: visible;
    }
  }

  // mobile
  @media (max-width: @grid-float-breakpoint-max) {
    clear: both;
    position: relative;
    .make-row;

    height: @navbar-collapse-max-height;
    overflow: auto;

    > .nav > li {
      float: none;
    }

    li.mmenu-dropdown {
      // ! this value is also used to detect breakpoint in navigation.js
      position: static;
    }

    ul > li {
      border-bottom: 2px solid @dropdown-divider-bg;
    }
  }
}

ul.mmenu-dropdown-menu {

  position: absolute;
  z-index: @zindex-dropdown;
  min-width: 100%;
  white-space: nowrap;

  ul.mmenu-dropdown-menu {
    top: 0;
    left: 100%;
  }

  &.nav-stacked > li {
    margin-top: 0;
  }

  // mobile
  @media (max-width: @grid-float-breakpoint-max) {
    height: @navbar-collapse-max-height;

    .transition(left .2s ease-in);
    left: 100%;
    top: 0;

    li.click-open > & {
      .transition(left .2s ease-out);
      left: 0;
    }
  }

  // desktop
  @media (min-width: @grid-float-breakpoint) {
    .transition(all 0s linear .15s);

    visibility: hidden;
    :hover > & {
      visibility: visible;
    }

    > .mmenu-back {
      display: none;
    }
  }

  // look

  @dropdown-level-darkening: 14%;

  .submenu-colors (@dropdown-color) {

    background-color: @dropdown-color;
    > li {
      > a {
        color: contrast(@dropdown-color, @dropdown-link-color, @nav-pills-active-link-hover-color, 60%);
      }
      &:hover > a {
        background-color: darken(@dropdown-color, @dropdown-level-darkening);
      }
    }
  }

  // level 1
  .submenu-colors(@dropdown-bg);

  // level 2
  ul.mmenu-dropdown-menu {
    .submenu-colors(darken(@dropdown-bg, @dropdown-level-darkening));
  }

  // level 3
  ul.mmenu-dropdown-menu ul.mmenu-dropdown-menu {
    .submenu-colors(darken(@dropdown-bg, @dropdown-level-darkening * 2));
  }

  > li.mmenu-back {
    background-color: @dropdown-divider-bg;
    > a {
      color: @link-color !important;
      &:hover {
        color: @nav-pills-active-link-hover-color !important;
      }
    }
  }
}

.mmenu-toggle {
  @media (min-width: @grid-float-breakpoint) {
    display: none;
  }
  @media (max-width: @grid-float-breakpoint-max) {
    border-color: @navbar-default-toggle-border-color;
    &:hover,
    &:focus {
      background-color: @navbar-default-toggle-hover-bg;
    }
    .icon-bar {
      background-color: @navbar-default-toggle-icon-bar-bg;
    }
  }
}